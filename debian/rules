#!/usr/bin/make -f

# Split this up a bit to avoid long lines
CONFIGURE_GDA_PATH = /usr/share/gnome-control-center/default-apps
CONFIGURE_GDA = --with-gnome-default-applications=$(CONFIGURE_GDA_PATH)
CONFIGURE_COMMON = $(CONFIGURE_GDA) CFLAGS="-Wl,--as-needed -Wall"

%:
	dh $@

override_dh_auto_configure:
	dh_auto_configure --builddirectory=build-gtk2 -proxterm-gtk2 \
		-- --disable-gtk3 $(CONFIGURE_COMMON)
	dh_auto_configure -proxterm-common -proxterm \
		-- --enable-gtk3 $(CONFIGURE_COMMON)

override_dh_auto_build:
	dh_auto_build --parallel --builddirectory=build-gtk2 -proxterm-gtk2
	dh_auto_build --parallel -proxterm-common -proxterm

override_dh_auto_install:
	dh_auto_install -proxterm-common -proxterm

override_dh_install:
	dh_install
	dh_install -proxterm-gtk2 build-gtk2/src/roxterm usr/bin/
	dh_install -proxterm-gtk2 build-gtk2/src/roxterm-config usr/bin/
	dh_install -proxterm-common debian/roxterm.xpm usr/share/pixmaps/

override_dh_auto_test:
	dh_auto_test -proxterm-gtk2 --builddirectory=build-gtk2
	dh_auto_test -proxterm-common -proxterm

override_dh_auto_clean:
	dh_auto_clean
	rm -rf build-gtk2
